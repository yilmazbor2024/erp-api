SELECT        dbo.trOrderHeader.OrderHeaderID, dbo.trOrderHeader.OrderTypeCode, dbo.trOrderHeader.ProcessCode, dbo.trOrderHeader.OrderNumber, dbo.trOrderHeader.OrderDate, dbo.trOrderHeader.OrderTime, 
                         dbo.trOrderHeader.DocumentNumber, dbo.trOrderHeader.PaymentTerm, dbo.trOrderHeader.AverageDueDate, dbo.trOrderHeader.Description, dbo.trOrderHeader.InternalDescription, dbo.trOrderHeader.CurrAccTypeCode, 
                         dbo.trOrderHeader.CurrAccCode, dbo.trOrderHeader.SubCurrAccID, dbo.trOrderHeader.ContactID, dbo.trOrderHeader.ShipmentMethodCode, dbo.trOrderHeader.ShippingPostalAddressID, 
                         dbo.trOrderHeader.BillingPostalAddressID, dbo.trOrderHeader.GuarantorContactID, dbo.trOrderHeader.GuarantorContactID2, dbo.trOrderHeader.RoundsmanCode, dbo.trOrderHeader.DeliveryCompanyCode, 
                         dbo.trOrderHeader.TaxTypeCode, dbo.trOrderHeader.TaxExemptionCode, dbo.trOrderHeader.CompanyCode, dbo.trOrderHeader.OfficeCode, dbo.trOrderHeader.StoreTypeCode, dbo.trOrderHeader.StoreCode, 
                         dbo.trOrderHeader.POSTerminalID, dbo.trOrderHeader.WarehouseCode, dbo.trOrderHeader.ToWarehouseCode, dbo.trOrderHeader.OrdererCompanyCode, dbo.trOrderHeader.OrdererOfficeCode, 
                         dbo.trOrderHeader.OrdererStoreCode, dbo.trOrderHeader.GLTypeCode, dbo.trOrderHeader.LocalCurrencyCode, dbo.trOrderHeader.ExchangeRate, dbo.trOrderHeader.TDisRate1, dbo.trOrderHeader.TDisRate2, 
                         dbo.trOrderHeader.TDisRate3, dbo.trOrderHeader.TDisRate4, dbo.trOrderHeader.TDisRate5, dbo.trOrderHeader.DiscountReasonCode, dbo.trOrderHeader.SurplusOrderQtyToleranceRate, dbo.trOrderHeader.ImportFileNumber, 
                         dbo.trOrderHeader.ExportFileNumber, dbo.trOrderHeader.IncotermCode1, dbo.trOrderHeader.IncotermCode2, dbo.trOrderHeader.LettersOfCreditNumber, dbo.trOrderHeader.PaymentMethodCode, dbo.trOrderHeader.IsInclutedVat, 
                         dbo.trOrderHeader.IsCreditSale, dbo.trOrderHeader.IsCreditableConfirmed, dbo.trOrderHeader.CreditableConfirmedUser, dbo.trOrderHeader.CreditableConfirmedDate, dbo.trOrderHeader.IsSalesViaInternet, 
                         dbo.trOrderHeader.IsProposalBased, dbo.trOrderHeader.IsSuspended, dbo.trOrderHeader.IsCompleted, dbo.trOrderHeader.IsPrinted, dbo.trOrderHeader.IsLocked, dbo.trOrderHeader.UserLocked, 
                         dbo.trOrderHeader.ApplicationCode, dbo.trOrderHeader.ApplicationID, dbo.trOrderHeader.CreatedUserName, dbo.trOrderHeader.CreatedDate, dbo.trOrderHeader.LastUpdatedUserName, dbo.trOrderHeader.LastUpdatedDate, 
                         dbo.trOrderLine.OrderLineID, dbo.trOrderLine.SortOrder, dbo.trOrderLine.ItemTypeCode, dbo.trOrderLine.ItemCode, dbo.trOrderLine.ColorCode, dbo.trOrderLine.ItemDim1Code, dbo.trOrderLine.ItemDim2Code, 
                         dbo.trOrderLine.ItemDim3Code, dbo.trOrderLine.Qty1, dbo.trOrderLine.Qty2, dbo.trOrderLine.CancelQty1, dbo.trOrderLine.CancelQty2, dbo.trOrderLine.CancelDate, dbo.trOrderLine.OrderCancelReasonCode, 
                         dbo.trOrderLine.ClosedDate, dbo.trOrderLine.IsClosed, dbo.trOrderLine.SalespersonCode, dbo.trOrderLine.PaymentPlanCode, dbo.trOrderLine.PurchasePlanCode, dbo.trOrderLine.DeliveryDate, 
                         dbo.trOrderLine.PlannedDateOfLading, dbo.trOrderLine.LineDescription, dbo.trOrderLine.UsedBarcode, dbo.trOrderLine.CostCenterCode, 
                         CASE WHEN trOrderHeader.TaxTypeCode = 7 THEN trOrderLine.WithHoldingTaxTypeCode ELSE trOrderHeader.WithHoldingTaxTypeCode END AS WithHoldingTaxTypeCode, 
                         CASE WHEN trOrderHeader.TaxTypeCode = 7 THEN trOrderLine.DovCode ELSE trOrderHeader.DovCode END AS DovCode, dbo.trOrderLine.VatCode, dbo.trOrderLine.VatRate, dbo.trOrderLine.PCTCode, dbo.trOrderLine.PCTRate, 
                         dbo.trOrderLine.LDisRate1, dbo.trOrderLine.LDisRate2, dbo.trOrderLine.LDisRate3, dbo.trOrderLine.LDisRate4, dbo.trOrderLine.LDisRate5, dbo.trOrderLine.DocCurrencyCode, dbo.trOrderLine.PriceCurrencyCode, 
                         dbo.trOrderLine.PriceExchangeRate, dbo.trOrderLine.Price, dbo.trOrderLine.PriceListLineID, dbo.trOrderLine.BaseProcessCode, dbo.trOrderLine.BaseOrderNumber, dbo.trOrderLine.BaseCustomerTypeCode, 
                         dbo.trOrderLine.BaseCustomerCode, dbo.trOrderLine.BaseSubCurrAccID, dbo.trOrderLine.BaseStoreCode, dbo.trOrderLine.SupportRequestHeaderID, dbo.trOrderLine.PurchaseRequisitionLineID, 
                         dbo.trOrderLine.OrderLineLinkedProductID, dbo.trOrderLine.SurplusOrderQtyToleranceRate AS LineSurplusOrderQtyToleranceRate, dbo.trOrderLine.OrderLineSumID, dbo.trOrderLine.OrderLineBOMID
FROM            dbo.trOrderHeader WITH (NOLOCK) INNER JOIN
                         dbo.trOrderLine WITH (NOLOCK) ON dbo.trOrderLine.OrderHeaderID = dbo.trOrderHeader.OrderHeaderID
